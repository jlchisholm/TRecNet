Model Name: TRecNet 
Model ID: TRecNet_4jets_20230602_095841 

 ---------------------------------------------------  
Training Data File: /mnt/xrootdg/jchishol/mntuples_08_01_22/variables_ttbar_ljets_10j_train.h5 
X Maxmean File: /mnt/xrootdg/jchishol/mntuples_08_01_22/X_maxmean_variables_ttbar_ljets_10j_train.npy 
Y Maxmean File: /mnt/xrootdg/jchishol/mntuples_08_01_22/Y_maxmean_variables_ttbar_ljets_10j_train.npy 

 ---------------------------------------------------  
X Keys: j1_pt, j1_eta, j1_phi, j1_m, j1_isbtag, j2_pt, j2_eta, j2_phi, j2_m, j2_isbtag, j3_pt, j3_eta, j3_phi, j3_m, j3_isbtag, j4_pt, j4_eta, j4_phi, j4_m, j4_isbtag, lep_pt, lep_eta, lep_phi, met_met, met_phi
X Scaled Keys: j1_pt, j1_px, j1_py, j1_eta, j1_m, j1_isbtag, j2_pt, j2_px, j2_py, j2_eta, j2_m, j2_isbtag, j3_pt, j3_px, j3_py, j3_eta, j3_m, j3_isbtag, j4_pt, j4_px, j4_py, j4_eta, j4_m, j4_isbtag, lep_pt, lep_px, lep_py, lep_eta, met_met, met_phi-sin, met_phi-cos
Y Keys: th_pt, th_eta, th_phi, th_m, wh_pt, wh_eta, wh_phi, wh_m, tl_pt, tl_eta, tl_phi, tl_m, wl_pt, wl_eta, wl_phi, wl_m
Y Scaled Keys: th_pt, th_px, th_py, th_eta, th_m, wh_pt, wh_px, wh_py, wh_eta, wh_m, tl_pt, tl_px, tl_py, tl_eta, tl_m, wl_pt, wl_px, wl_py, wl_eta, wl_m

 ---------------------------------------------------  
Learning Rate: Polynomial Decay with initial_lr=0.001, final_lr=5e-05, decay_step=10000, and power=0.25 
Batch Size: 1000 
Max Number of Epochs: 256 
Number of Epochs Used: 192 
Patience: 8 
Training Time: 00:07:17:17 
Training History: 
     loss      mse  val_loss  val_mse
0.021537 0.001605  0.020539 0.001527
0.020469 0.001521  0.020431 0.001516
0.020369 0.001513  0.020350 0.001513
0.020289 0.001507  0.020272 0.001509
0.020219 0.001502  0.020212 0.001506
0.020158 0.001497  0.020149 0.001497
0.020103 0.001493  0.020100 0.001492
0.020054 0.001489  0.020059 0.001494
0.020008 0.001485  0.020014 0.001489
0.019965 0.001482  0.019979 0.001487
0.019925 0.001478  0.019950 0.001484
0.019888 0.001475  0.019910 0.001484
0.019853 0.001473  0.019877 0.001478
0.019820 0.001470  0.019853 0.001478
0.019790 0.001467  0.019818 0.001474
0.019761 0.001465  0.019793 0.001472
0.019734 0.001462  0.019767 0.001470
0.019709 0.001460  0.019745 0.001468
0.019686 0.001458  0.019730 0.001466
0.019664 0.001456  0.019705 0.001465
0.019643 0.001455  0.019691 0.001461
0.019623 0.001453  0.019672 0.001463
0.019605 0.001451  0.019652 0.001459
0.019587 0.001450  0.019647 0.001461
0.019570 0.001448  0.019623 0.001457
0.019554 0.001447  0.019606 0.001458
0.019538 0.001445  0.019600 0.001456
0.019522 0.001444  0.019586 0.001455
0.019507 0.001443  0.019567 0.001452
0.019492 0.001441  0.019549 0.001453
0.019478 0.001440  0.019540 0.001453
0.019463 0.001439  0.019530 0.001451
0.019449 0.001438  0.019522 0.001452
0.019436 0.001436  0.019495 0.001449
0.019423 0.001435  0.019489 0.001445
0.019410 0.001434  0.019482 0.001446
0.019398 0.001433  0.019471 0.001446
0.019386 0.001432  0.019458 0.001444
0.019374 0.001431  0.019440 0.001444
0.019362 0.001430  0.019438 0.001441
0.019352 0.001429  0.019429 0.001443
0.019341 0.001428  0.019416 0.001442
0.019330 0.001427  0.019410 0.001441
0.019320 0.001426  0.019397 0.001439
0.019309 0.001425  0.019388 0.001435
0.019299 0.001424  0.019387 0.001438
0.019290 0.001423  0.019370 0.001437
0.019281 0.001423  0.019361 0.001437
0.019272 0.001422  0.019357 0.001437
0.019264 0.001421  0.019347 0.001432
0.019255 0.001420  0.019338 0.001434
0.019247 0.001420  0.019333 0.001435
0.019239 0.001419  0.019328 0.001432
0.019232 0.001418  0.019319 0.001433
0.019224 0.001418  0.019319 0.001435
0.019217 0.001417  0.019307 0.001435
0.019210 0.001416  0.019307 0.001433
0.019204 0.001416  0.019294 0.001430
0.019197 0.001415  0.019292 0.001432
0.019191 0.001415  0.019288 0.001430
0.019184 0.001414  0.019277 0.001431
0.019178 0.001414  0.019267 0.001429
0.019172 0.001413  0.019269 0.001429
0.019166 0.001413  0.019268 0.001430
0.019160 0.001412  0.019261 0.001427
0.019155 0.001412  0.019256 0.001430
0.019149 0.001411  0.019252 0.001427
0.019144 0.001411  0.019249 0.001429
0.019139 0.001410  0.019244 0.001428
0.019133 0.001410  0.019243 0.001427
0.019128 0.001409  0.019238 0.001426
0.019123 0.001409  0.019232 0.001425
0.019118 0.001408  0.019227 0.001428
0.019113 0.001408  0.019217 0.001429
0.019108 0.001408  0.019218 0.001426
0.019104 0.001407  0.019218 0.001429
0.019099 0.001407  0.019210 0.001428
0.019095 0.001406  0.019212 0.001424
0.019090 0.001406  0.019207 0.001426
0.019086 0.001406  0.019199 0.001425
0.019082 0.001405  0.019206 0.001426
0.019078 0.001405  0.019191 0.001425
0.019074 0.001405  0.019189 0.001424
0.019070 0.001404  0.019182 0.001424
0.019066 0.001404  0.019180 0.001424
0.019062 0.001403  0.019187 0.001426
0.019059 0.001403  0.019180 0.001424
0.019055 0.001403  0.019180 0.001426
0.019051 0.001402  0.019178 0.001422
0.019048 0.001402  0.019168 0.001425
0.019044 0.001402  0.019165 0.001424
0.019041 0.001401  0.019162 0.001422
0.019037 0.001401  0.019173 0.001426
0.019034 0.001401  0.019159 0.001421
0.019031 0.001401  0.019161 0.001423
0.019028 0.001400  0.019160 0.001423
0.019024 0.001400  0.019153 0.001425
0.019022 0.001400  0.019149 0.001422
0.019018 0.001399  0.019155 0.001423
0.019015 0.001399  0.019144 0.001423
0.019012 0.001399  0.019145 0.001420
0.019009 0.001399  0.019144 0.001420
0.019006 0.001398  0.019144 0.001424
0.019003 0.001398  0.019134 0.001420
0.019000 0.001398  0.019143 0.001422
0.018998 0.001398  0.019134 0.001421
0.018995 0.001397  0.019136 0.001421
0.018992 0.001397  0.019138 0.001420
0.018989 0.001397  0.019126 0.001422
0.018986 0.001396  0.019129 0.001420
0.018984 0.001396  0.019121 0.001421
0.018981 0.001396  0.019127 0.001421
0.018979 0.001396  0.019123 0.001418
0.018976 0.001395  0.019126 0.001421
0.018973 0.001395  0.019120 0.001420
0.018971 0.001395  0.019117 0.001418
0.018968 0.001395  0.019116 0.001421
0.018966 0.001394  0.019118 0.001423
0.018963 0.001394  0.019115 0.001422
0.018961 0.001394  0.019105 0.001420
0.018959 0.001394  0.019108 0.001420
0.018956 0.001393  0.019101 0.001419
0.018954 0.001393  0.019110 0.001423
0.018952 0.001393  0.019102 0.001418
0.018949 0.001393  0.019100 0.001420
0.018947 0.001393  0.019106 0.001423
0.018945 0.001392  0.019098 0.001421
0.018943 0.001392  0.019100 0.001419
0.018940 0.001392  0.019095 0.001419
0.018939 0.001392  0.019095 0.001419
0.018936 0.001392  0.019094 0.001419
0.018934 0.001391  0.019092 0.001418
0.018932 0.001391  0.019101 0.001422
0.018930 0.001391  0.019088 0.001418
0.018928 0.001391  0.019091 0.001421
0.018926 0.001391  0.019090 0.001419
0.018924 0.001390  0.019089 0.001422
0.018922 0.001390  0.019084 0.001419
0.018920 0.001390  0.019084 0.001421
0.018918 0.001390  0.019081 0.001419
0.018916 0.001390  0.019083 0.001419
0.018914 0.001389  0.019080 0.001420
0.018912 0.001389  0.019082 0.001419
0.018910 0.001389  0.019076 0.001419
0.018909 0.001389  0.019074 0.001418
0.018907 0.001389  0.019076 0.001418
0.018905 0.001389  0.019076 0.001419
0.018903 0.001388  0.019075 0.001421
0.018901 0.001388  0.019078 0.001421
0.018900 0.001388  0.019072 0.001418
0.018898 0.001388  0.019073 0.001421
0.018896 0.001388  0.019070 0.001417
0.018894 0.001387  0.019070 0.001418
0.018892 0.001387  0.019068 0.001417
0.018891 0.001387  0.019072 0.001420
0.018889 0.001387  0.019072 0.001420
0.018888 0.001387  0.019063 0.001419
0.018886 0.001386  0.019069 0.001415
0.018884 0.001386  0.019060 0.001419
0.018883 0.001386  0.019063 0.001419
0.018881 0.001386  0.019062 0.001420
0.018879 0.001386  0.019062 0.001418
0.018878 0.001386  0.019064 0.001417
0.018876 0.001386  0.019062 0.001418
0.018875 0.001385  0.019062 0.001419
0.018873 0.001385  0.019056 0.001418
0.018872 0.001385  0.019055 0.001417
0.018870 0.001385  0.019059 0.001419
0.018870 0.001385  0.019059 0.001420
0.018868 0.001385  0.019054 0.001418
0.018866 0.001384  0.019054 0.001415
0.018865 0.001384  0.019051 0.001420
0.018863 0.001384  0.019056 0.001418
0.018862 0.001384  0.019051 0.001417
0.018861 0.001384  0.019045 0.001418
0.018859 0.001384  0.019047 0.001418
0.018858 0.001384  0.019044 0.001416
0.018857 0.001383  0.019046 0.001418
0.018855 0.001383  0.019045 0.001418
0.018854 0.001383  0.019050 0.001418
0.018853 0.001383  0.019045 0.001419
0.018852 0.001383  0.019048 0.001420
0.018850 0.001383  0.019052 0.001418
0.018849 0.001383  0.019041 0.001417
0.018847 0.001382  0.019044 0.001417
0.018847 0.001382  0.019049 0.001419
0.018845 0.001382  0.019052 0.001420
0.018844 0.001382  0.019042 0.001418
0.018843 0.001382  0.019041 0.001417
0.018842 0.001382  0.019042 0.001420
0.018840 0.001381  0.019042 0.001421
0.018839 0.001381  0.019045 0.001415 

 ---------------------------------------------------  
Model Architecture:
Model: "model"
_____________________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     Trainable  
=============================================================================================================
 jet_input (InputLayer)         [(None, 4, 6)]       0           []                               Y          
                                                                                                             
 other_input (InputLayer)       [(None, 7)]          0           []                               Y          
                                                                                                             
 flattened_jets (Flatten)       (None, 24)           0           ['jet_input[0][0]']              Y          
                                                                                                             
 concat_jets_other (Concatenate  (None, 31)          0           ['other_input[0][0]',            Y          
 )                                                                'flattened_jets[0][0]']                    
                                                                                                             
 dense256_1 (Dense)             (None, 256)          8192        ['concat_jets_other[0][0]']      Y          
                                                                                                             
 masking_jets (Masking)         (None, 4, 6)         0           ['jet_input[0][0]']              Y          
                                                                                                             
 dense256_2 (Dense)             (None, 256)          65792       ['dense256_1[0][0]']             Y          
                                                                                                             
 reshape_masked_jets (Reshape)  (None, 4, 6)         0           ['masking_jets[0][0]']           Y          
                                                                                                             
 dense6_sigmoid (Dense)         (None, 4)            1028        ['dense256_2[0][0]']             Y          
                                                                                                             
 TDDense128 (TimeDistributed)   (None, 4, 128)       896         ['reshape_masked_jets[0][0]']    Y          
                                                                                                             
 reshape (Reshape)              (None, 4, 1)         0           ['dense6_sigmoid[0][0]']         Y          
                                                                                                             
 TDDense64 (TimeDistributed)    (None, 4, 64)        8256        ['TDDense128[0][0]']             Y          
                                                                                                             
 weight_jets (Multiply)         (None, 4, 64)        0           ['reshape[0][0]',                Y          
                                                                  'TDDense64[0][0]']                         
                                                                                                             
 dense128 (Dense)               (None, 128)          1024        ['other_input[0][0]']            Y          
                                                                                                             
 TDDense256_1 (TimeDistributed)  (None, 4, 256)      16640       ['weight_jets[0][0]']            Y          
                                                                                                             
 dense64 (Dense)                (None, 64)           8256        ['dense128[0][0]']               Y          
                                                                                                             
 TDDense256_2 (TimeDistributed)  (None, 4, 256)      65792       ['TDDense256_1[0][0]']           Y          
                                                                                                             
 flattened_other (Flatten)      (None, 64)           0           ['dense64[0][0]']                Y          
                                                                                                             
 flattened_weighted_jets (Flatt  (None, 1024)        0           ['TDDense256_2[0][0]']           Y          
 en)                                                                                                         
                                                                                                             
 concat_everything (Concatenate  (None, 1088)        0           ['flattened_other[0][0]',        Y          
 )                                                                'flattened_weighted_jets[0][0]             
                                                                 ']                                          
                                                                                                             
 ldense256 (Dense)              (None, 256)          278784      ['concat_everything[0][0]']      Y          
                                                                                                             
 ldense128 (Dense)              (None, 128)          32896       ['ldense256[0][0]']              Y          
                                                                                                             
 lep_output (Dense)             (None, 10)           1290        ['ldense128[0][0]']              Y          
                                                                                                             
 concatenate (Concatenate)      (None, 1098)         0           ['lep_output[0][0]',             Y          
                                                                  'concat_everything[0][0]']                 
                                                                                                             
 hdense256 (Dense)              (None, 256)          281344      ['concatenate[0][0]']            Y          
                                                                                                             
 hdense128 (Dense)              (None, 128)          32896       ['hdense256[0][0]']              Y          
                                                                                                             
 had_output (Dense)             (None, 10)           1290        ['hdense128[0][0]']              Y          
                                                                                                             
 output (Concatenate)           (None, 20)           0           ['had_output[0][0]',             Y          
                                                                  'lep_output[0][0]']                        
                                                                                                             
=============================================================================================================
Total params: 804,376
Trainable params: 804,376
Non-trainable params: 0
_____________________________________________________________________________________________________________
