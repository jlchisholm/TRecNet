Model Name: TRecNet 
Model ID: TRecNet_5jets_20230601_223623 

 ---------------------------------------------------  
Training Data File: /mnt/xrootdg/jchishol/mntuples_08_01_22/variables_ttbar_ljets_10j_train.h5 
X Maxmean File: /mnt/xrootdg/jchishol/mntuples_08_01_22/X_maxmean_variables_ttbar_ljets_10j_train.npy 
Y Maxmean File: /mnt/xrootdg/jchishol/mntuples_08_01_22/Y_maxmean_variables_ttbar_ljets_10j_train.npy 

 ---------------------------------------------------  
X Keys: j1_pt, j1_eta, j1_phi, j1_m, j1_isbtag, j2_pt, j2_eta, j2_phi, j2_m, j2_isbtag, j3_pt, j3_eta, j3_phi, j3_m, j3_isbtag, j4_pt, j4_eta, j4_phi, j4_m, j4_isbtag, j5_pt, j5_eta, j5_phi, j5_m, j5_isbtag, lep_pt, lep_eta, lep_phi, met_met, met_phi
X Scaled Keys: j1_pt, j1_px, j1_py, j1_eta, j1_m, j1_isbtag, j2_pt, j2_px, j2_py, j2_eta, j2_m, j2_isbtag, j3_pt, j3_px, j3_py, j3_eta, j3_m, j3_isbtag, j4_pt, j4_px, j4_py, j4_eta, j4_m, j4_isbtag, j5_pt, j5_px, j5_py, j5_eta, j5_m, j5_isbtag, lep_pt, lep_px, lep_py, lep_eta, met_met, met_phi-sin, met_phi-cos
Y Keys: th_pt, th_eta, th_phi, th_m, wh_pt, wh_eta, wh_phi, wh_m, tl_pt, tl_eta, tl_phi, tl_m, wl_pt, wl_eta, wl_phi, wl_m
Y Scaled Keys: th_pt, th_px, th_py, th_eta, th_m, wh_pt, wh_px, wh_py, wh_eta, wh_m, tl_pt, tl_px, tl_py, tl_eta, tl_m, wl_pt, wl_px, wl_py, wl_eta, wl_m

 ---------------------------------------------------  
Learning Rate: Polynomial Decay with initial_lr=0.001, final_lr=5e-05, decay_step=10000, and power=0.25 
Batch Size: 1000 
Max Number of Epochs: 256 
Number of Epochs Used: 252 
Patience: 8 
Training Time: 00:09:46:47 
Training History: 
     loss      mse  val_loss  val_mse
0.021151 0.001515  0.020151 0.001436
0.020070 0.001427  0.020038 0.001429
0.019970 0.001420  0.019962 0.001422
0.019890 0.001414  0.019894 0.001420
0.019821 0.001409  0.019830 0.001413
0.019759 0.001405  0.019773 0.001412
0.019703 0.001401  0.019724 0.001405
0.019652 0.001397  0.019674 0.001402
0.019604 0.001394  0.019633 0.001403
0.019559 0.001391  0.019595 0.001397
0.019518 0.001388  0.019560 0.001396
0.019480 0.001385  0.019522 0.001394
0.019443 0.001382  0.019496 0.001393
0.019410 0.001380  0.019456 0.001390
0.019378 0.001378  0.019427 0.001387
0.019348 0.001375  0.019405 0.001385
0.019319 0.001373  0.019383 0.001385
0.019292 0.001371  0.019360 0.001382
0.019267 0.001369  0.019331 0.001379
0.019242 0.001367  0.019314 0.001379
0.019219 0.001365  0.019294 0.001382
0.019197 0.001364  0.019277 0.001379
0.019176 0.001362  0.019259 0.001375
0.019156 0.001361  0.019237 0.001375
0.019137 0.001359  0.019224 0.001374
0.019118 0.001358  0.019206 0.001373
0.019101 0.001356  0.019193 0.001371
0.019084 0.001355  0.019175 0.001372
0.019068 0.001354  0.019159 0.001370
0.019052 0.001353  0.019143 0.001369
0.019037 0.001351  0.019139 0.001367
0.019022 0.001350  0.019128 0.001368
0.019007 0.001349  0.019108 0.001368
0.018993 0.001348  0.019093 0.001364
0.018979 0.001347  0.019086 0.001367
0.018965 0.001346  0.019075 0.001364
0.018952 0.001345  0.019061 0.001363
0.018938 0.001344  0.019047 0.001360
0.018925 0.001343  0.019037 0.001362
0.018912 0.001342  0.019033 0.001362
0.018899 0.001340  0.019013 0.001357
0.018887 0.001340  0.019020 0.001363
0.018875 0.001338  0.019000 0.001360
0.018864 0.001338  0.018988 0.001359
0.018852 0.001337  0.018978 0.001358
0.018842 0.001336  0.018962 0.001358
0.018831 0.001335  0.018966 0.001357
0.018821 0.001334  0.018964 0.001357
0.018811 0.001333  0.018936 0.001354
0.018801 0.001332  0.018934 0.001355
0.018792 0.001332  0.018934 0.001354
0.018782 0.001331  0.018917 0.001355
0.018773 0.001330  0.018911 0.001352
0.018764 0.001329  0.018902 0.001353
0.018755 0.001329  0.018908 0.001354
0.018747 0.001328  0.018886 0.001351
0.018739 0.001327  0.018881 0.001350
0.018731 0.001327  0.018877 0.001352
0.018723 0.001326  0.018875 0.001350
0.018715 0.001325  0.018865 0.001351
0.018708 0.001325  0.018862 0.001350
0.018701 0.001324  0.018850 0.001349
0.018693 0.001323  0.018842 0.001349
0.018686 0.001323  0.018840 0.001349
0.018679 0.001322  0.018830 0.001349
0.018673 0.001322  0.018831 0.001346
0.018666 0.001321  0.018828 0.001347
0.018660 0.001321  0.018821 0.001348
0.018653 0.001320  0.018816 0.001348
0.018647 0.001319  0.018809 0.001348
0.018641 0.001319  0.018810 0.001349
0.018635 0.001318  0.018795 0.001345
0.018629 0.001318  0.018794 0.001346
0.018623 0.001317  0.018785 0.001343
0.018617 0.001317  0.018788 0.001346
0.018611 0.001316  0.018782 0.001345
0.018606 0.001316  0.018775 0.001344
0.018600 0.001315  0.018769 0.001344
0.018595 0.001315  0.018770 0.001346
0.018589 0.001314  0.018763 0.001344
0.018584 0.001314  0.018763 0.001343
0.018579 0.001313  0.018758 0.001343
0.018574 0.001313  0.018755 0.001342
0.018569 0.001313  0.018747 0.001343
0.018564 0.001312  0.018747 0.001343
0.018558 0.001312  0.018742 0.001343
0.018554 0.001311  0.018741 0.001343
0.018549 0.001311  0.018741 0.001344
0.018544 0.001310  0.018729 0.001341
0.018539 0.001310  0.018732 0.001342
0.018535 0.001310  0.018731 0.001340
0.018530 0.001309  0.018720 0.001340
0.018525 0.001309  0.018714 0.001340
0.018521 0.001308  0.018711 0.001342
0.018516 0.001308  0.018720 0.001341
0.018512 0.001307  0.018712 0.001340
0.018508 0.001307  0.018715 0.001342
0.018504 0.001307  0.018697 0.001340
0.018499 0.001306  0.018700 0.001341
0.018495 0.001306  0.018694 0.001338
0.018491 0.001305  0.018687 0.001337
0.018487 0.001305  0.018691 0.001340
0.018483 0.001305  0.018693 0.001339
0.018479 0.001304  0.018686 0.001340
0.018475 0.001304  0.018675 0.001337
0.018471 0.001304  0.018674 0.001338
0.018467 0.001303  0.018677 0.001340
0.018463 0.001303  0.018679 0.001337
0.018460 0.001303  0.018675 0.001337
0.018456 0.001302  0.018662 0.001339
0.018453 0.001302  0.018666 0.001337
0.018449 0.001302  0.018667 0.001338
0.018446 0.001301  0.018656 0.001336
0.018442 0.001301  0.018657 0.001338
0.018439 0.001301  0.018664 0.001339
0.018436 0.001300  0.018657 0.001337
0.018432 0.001300  0.018645 0.001337
0.018429 0.001300  0.018648 0.001336
0.018426 0.001299  0.018642 0.001336
0.018423 0.001299  0.018649 0.001338
0.018419 0.001299  0.018644 0.001339
0.018416 0.001298  0.018643 0.001334
0.018413 0.001298  0.018637 0.001336
0.018410 0.001298  0.018635 0.001336
0.018407 0.001297  0.018640 0.001338
0.018404 0.001297  0.018634 0.001336
0.018401 0.001297  0.018629 0.001335
0.018398 0.001297  0.018635 0.001338
0.018396 0.001296  0.018627 0.001336
0.018393 0.001296  0.018627 0.001335
0.018390 0.001296  0.018625 0.001334
0.018387 0.001295  0.018629 0.001332
0.018384 0.001295  0.018626 0.001336
0.018382 0.001295  0.018621 0.001337
0.018379 0.001295  0.018617 0.001335
0.018376 0.001294  0.018620 0.001336
0.018374 0.001294  0.018615 0.001337
0.018371 0.001294  0.018608 0.001333
0.018368 0.001294  0.018608 0.001335
0.018366 0.001293  0.018614 0.001335
0.018364 0.001293  0.018616 0.001334
0.018361 0.001293  0.018604 0.001336
0.018358 0.001293  0.018616 0.001335
0.018356 0.001292  0.018607 0.001335
0.018354 0.001292  0.018609 0.001332
0.018352 0.001292  0.018600 0.001337
0.018349 0.001292  0.018603 0.001334
0.018346 0.001291  0.018603 0.001335
0.018344 0.001291  0.018607 0.001335
0.018342 0.001291  0.018602 0.001335
0.018340 0.001291  0.018589 0.001333
0.018337 0.001290  0.018591 0.001334
0.018335 0.001290  0.018594 0.001335
0.018333 0.001290  0.018597 0.001335
0.018331 0.001290  0.018591 0.001335
0.018329 0.001290  0.018590 0.001333
0.018327 0.001289  0.018587 0.001335
0.018324 0.001289  0.018589 0.001336
0.018322 0.001289  0.018593 0.001336
0.018320 0.001289  0.018586 0.001335
0.018318 0.001288  0.018583 0.001333
0.018316 0.001288  0.018579 0.001334
0.018314 0.001288  0.018582 0.001333
0.018312 0.001288  0.018579 0.001333
0.018310 0.001288  0.018574 0.001334
0.018308 0.001287  0.018573 0.001332
0.018306 0.001287  0.018580 0.001335
0.018304 0.001287  0.018581 0.001335
0.018302 0.001287  0.018572 0.001334
0.018300 0.001286  0.018575 0.001335
0.018298 0.001286  0.018567 0.001334
0.018296 0.001286  0.018572 0.001335
0.018294 0.001286  0.018570 0.001331
0.018292 0.001286  0.018567 0.001332
0.018290 0.001286  0.018567 0.001334
0.018288 0.001285  0.018561 0.001333
0.018286 0.001285  0.018566 0.001333
0.018284 0.001285  0.018569 0.001336
0.018282 0.001285  0.018567 0.001332
0.018281 0.001285  0.018567 0.001335
0.018279 0.001284  0.018554 0.001335
0.018277 0.001284  0.018556 0.001333
0.018275 0.001284  0.018566 0.001332
0.018274 0.001284  0.018551 0.001333
0.018271 0.001283  0.018559 0.001334
0.018270 0.001284  0.018557 0.001334
0.018268 0.001283  0.018551 0.001333
0.018266 0.001283  0.018553 0.001334
0.018265 0.001283  0.018557 0.001333
0.018263 0.001283  0.018562 0.001334
0.018261 0.001283  0.018547 0.001333
0.018260 0.001282  0.018551 0.001332
0.018258 0.001282  0.018555 0.001333
0.018257 0.001282  0.018550 0.001334
0.018255 0.001282  0.018550 0.001332
0.018253 0.001282  0.018547 0.001333
0.018252 0.001282  0.018545 0.001331
0.018250 0.001281  0.018549 0.001333
0.018249 0.001281  0.018555 0.001334
0.018247 0.001281  0.018544 0.001333
0.018246 0.001281  0.018537 0.001332
0.018244 0.001281  0.018546 0.001333
0.018243 0.001281  0.018546 0.001334
0.018241 0.001280  0.018541 0.001334
0.018240 0.001280  0.018542 0.001332
0.018238 0.001280  0.018536 0.001334
0.018236 0.001280  0.018543 0.001334
0.018235 0.001280  0.018542 0.001334
0.018234 0.001279  0.018538 0.001334
0.018233 0.001279  0.018542 0.001332
0.018231 0.001279  0.018547 0.001335
0.018229 0.001279  0.018537 0.001335
0.018228 0.001279  0.018535 0.001332
0.018226 0.001279  0.018532 0.001333
0.018226 0.001278  0.018528 0.001333
0.018224 0.001278  0.018536 0.001332
0.018223 0.001278  0.018541 0.001336
0.018221 0.001278  0.018528 0.001333
0.018220 0.001278  0.018539 0.001336
0.018219 0.001278  0.018535 0.001332
0.018217 0.001278  0.018535 0.001332
0.018216 0.001277  0.018528 0.001331
0.018215 0.001277  0.018528 0.001334
0.018213 0.001277  0.018530 0.001333
0.018212 0.001277  0.018530 0.001333
0.018211 0.001277  0.018539 0.001334
0.018210 0.001277  0.018525 0.001334
0.018209 0.001277  0.018527 0.001331
0.018207 0.001276  0.018531 0.001335
0.018206 0.001276  0.018529 0.001333
0.018205 0.001276  0.018526 0.001333
0.018203 0.001276  0.018526 0.001334
0.018202 0.001276  0.018527 0.001333
0.018201 0.001276  0.018531 0.001335
0.018200 0.001276  0.018523 0.001336
0.018199 0.001275  0.018533 0.001334
0.018198 0.001275  0.018531 0.001335
0.018196 0.001275  0.018523 0.001333
0.018195 0.001275  0.018525 0.001334
0.018194 0.001275  0.018528 0.001334
0.018193 0.001275  0.018521 0.001334
0.018192 0.001275  0.018519 0.001333
0.018190 0.001274  0.018525 0.001334
0.018190 0.001274  0.018518 0.001333
0.018188 0.001274  0.018519 0.001333
0.018188 0.001274  0.018525 0.001331
0.018186 0.001274  0.018523 0.001333
0.018185 0.001274  0.018525 0.001332
0.018184 0.001274  0.018520 0.001333
0.018183 0.001273  0.018522 0.001333
0.018182 0.001273  0.018519 0.001333
0.018181 0.001273  0.018522 0.001335 

 ---------------------------------------------------  
Model Architecture:
Model: "model"
_____________________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     Trainable  
=============================================================================================================
 jet_input (InputLayer)         [(None, 5, 6)]       0           []                               Y          
                                                                                                             
 other_input (InputLayer)       [(None, 7)]          0           []                               Y          
                                                                                                             
 flattened_jets (Flatten)       (None, 30)           0           ['jet_input[0][0]']              Y          
                                                                                                             
 concat_jets_other (Concatenate  (None, 37)          0           ['other_input[0][0]',            Y          
 )                                                                'flattened_jets[0][0]']                    
                                                                                                             
 dense256_1 (Dense)             (None, 256)          9728        ['concat_jets_other[0][0]']      Y          
                                                                                                             
 masking_jets (Masking)         (None, 5, 6)         0           ['jet_input[0][0]']              Y          
                                                                                                             
 dense256_2 (Dense)             (None, 256)          65792       ['dense256_1[0][0]']             Y          
                                                                                                             
 reshape_masked_jets (Reshape)  (None, 5, 6)         0           ['masking_jets[0][0]']           Y          
                                                                                                             
 dense6_sigmoid (Dense)         (None, 5)            1285        ['dense256_2[0][0]']             Y          
                                                                                                             
 TDDense128 (TimeDistributed)   (None, 5, 128)       896         ['reshape_masked_jets[0][0]']    Y          
                                                                                                             
 reshape (Reshape)              (None, 5, 1)         0           ['dense6_sigmoid[0][0]']         Y          
                                                                                                             
 TDDense64 (TimeDistributed)    (None, 5, 64)        8256        ['TDDense128[0][0]']             Y          
                                                                                                             
 weight_jets (Multiply)         (None, 5, 64)        0           ['reshape[0][0]',                Y          
                                                                  'TDDense64[0][0]']                         
                                                                                                             
 dense128 (Dense)               (None, 128)          1024        ['other_input[0][0]']            Y          
                                                                                                             
 TDDense256_1 (TimeDistributed)  (None, 5, 256)      16640       ['weight_jets[0][0]']            Y          
                                                                                                             
 dense64 (Dense)                (None, 64)           8256        ['dense128[0][0]']               Y          
                                                                                                             
 TDDense256_2 (TimeDistributed)  (None, 5, 256)      65792       ['TDDense256_1[0][0]']           Y          
                                                                                                             
 flattened_other (Flatten)      (None, 64)           0           ['dense64[0][0]']                Y          
                                                                                                             
 flattened_weighted_jets (Flatt  (None, 1280)        0           ['TDDense256_2[0][0]']           Y          
 en)                                                                                                         
                                                                                                             
 concat_everything (Concatenate  (None, 1344)        0           ['flattened_other[0][0]',        Y          
 )                                                                'flattened_weighted_jets[0][0]             
                                                                 ']                                          
                                                                                                             
 ldense256 (Dense)              (None, 256)          344320      ['concat_everything[0][0]']      Y          
                                                                                                             
 ldense128 (Dense)              (None, 128)          32896       ['ldense256[0][0]']              Y          
                                                                                                             
 lep_output (Dense)             (None, 10)           1290        ['ldense128[0][0]']              Y          
                                                                                                             
 concatenate (Concatenate)      (None, 1354)         0           ['lep_output[0][0]',             Y          
                                                                  'concat_everything[0][0]']                 
                                                                                                             
 hdense256 (Dense)              (None, 256)          346880      ['concatenate[0][0]']            Y          
                                                                                                             
 hdense128 (Dense)              (None, 128)          32896       ['hdense256[0][0]']              Y          
                                                                                                             
 had_output (Dense)             (None, 10)           1290        ['hdense128[0][0]']              Y          
                                                                                                             
 output (Concatenate)           (None, 20)           0           ['had_output[0][0]',             Y          
                                                                  'lep_output[0][0]']                        
                                                                                                             
=============================================================================================================
Total params: 937,241
Trainable params: 937,241
Non-trainable params: 0
_____________________________________________________________________________________________________________
