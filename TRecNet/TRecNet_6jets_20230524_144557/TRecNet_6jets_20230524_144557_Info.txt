Model Name: TRecNet 
Model ID: TRecNet_6jets_20230524_144557 

 ---------------------------------------------------  
Training Data File: /mnt/xrootdg/jchishol/mntuples_08_01_22/variables_ttbar_ljets_10j_train.h5 
X Maxmean File: /mnt/xrootdg/jchishol/mntuples_08_01_22/X_maxmean_variables_ttbar_ljets_10j_train.npy 
Y Maxmean File: /mnt/xrootdg/jchishol/mntuples_08_01_22/Y_maxmean_variables_ttbar_ljets_10j_train.npy 

 ---------------------------------------------------  
X Keys: j1_pt, j1_eta, j1_phi, j1_m, j1_isbtag, j2_pt, j2_eta, j2_phi, j2_m, j2_isbtag, j3_pt, j3_eta, j3_phi, j3_m, j3_isbtag, j4_pt, j4_eta, j4_phi, j4_m, j4_isbtag, j5_pt, j5_eta, j5_phi, j5_m, j5_isbtag, j6_pt, j6_eta, j6_phi, j6_m, j6_isbtag, lep_pt, lep_eta, lep_phi, met_met, met_phi
X Scaled Keys: j1_pt, j1_px, j1_py, j1_eta, j1_m, j1_isbtag, j2_pt, j2_px, j2_py, j2_eta, j2_m, j2_isbtag, j3_pt, j3_px, j3_py, j3_eta, j3_m, j3_isbtag, j4_pt, j4_px, j4_py, j4_eta, j4_m, j4_isbtag, j5_pt, j5_px, j5_py, j5_eta, j5_m, j5_isbtag, j6_pt, j6_px, j6_py, j6_eta, j6_m, j6_isbtag, lep_pt, lep_px, lep_py, lep_eta, met_met, met_phi-sin, met_phi-cos
Y Keys: th_pt, th_eta, th_phi, th_m, wh_pt, wh_eta, wh_phi, wh_m, tl_pt, tl_eta, tl_phi, tl_m, wl_pt, wl_eta, wl_phi, wl_m
Y Scaled Keys: th_pt, th_px, th_py, th_eta, th_m, wh_pt, wh_px, wh_py, wh_eta, wh_m, tl_pt, tl_px, tl_py, tl_eta, tl_m, wl_pt, wl_px, wl_py, wl_eta, wl_m

 ---------------------------------------------------  
Learning Rate: Polynomial Decay with initial_lr=0.001, final_lr=0.001, decay_step=10000, and power=0.25 
Batch Size: 10000 
Max Number of Epochs: 256 
Number of Epochs Used: 130 
Patience: 8 
Training Time: 00:01:50:51
Training History: 
     loss      mse  val_loss  val_mse
0.023790 0.001741  0.021168 0.001489
0.020797 0.001457  0.020492 0.001437
0.020309 0.001421  0.020173 0.001411
0.020031 0.001400  0.019948 0.001393
0.019837 0.001386  0.019763 0.001384
0.019696 0.001376  0.019698 0.001379
0.019577 0.001367  0.019586 0.001371
0.019475 0.001360  0.019484 0.001361
0.019384 0.001353  0.019438 0.001357
0.019309 0.001348  0.019331 0.001352
0.019242 0.001343  0.019260 0.001348
0.019181 0.001339  0.019213 0.001343
0.019127 0.001336  0.019186 0.001343
0.019075 0.001332  0.019135 0.001341
0.019031 0.001329  0.019077 0.001340
0.018982 0.001325  0.019045 0.001339
0.018940 0.001323  0.019022 0.001334
0.018902 0.001320  0.018945 0.001329
0.018867 0.001318  0.018939 0.001332
0.018834 0.001315  0.018883 0.001325
0.018802 0.001313  0.018877 0.001326
0.018776 0.001311  0.018856 0.001326
0.018749 0.001309  0.018822 0.001323
0.018724 0.001307  0.018819 0.001323
0.018702 0.001305  0.018777 0.001320
0.018677 0.001303  0.018760 0.001321
0.018653 0.001302  0.018735 0.001314
0.018631 0.001300  0.018756 0.001318
0.018611 0.001298  0.018690 0.001310
0.018588 0.001297  0.018697 0.001310
0.018568 0.001295  0.018656 0.001310
0.018549 0.001294  0.018648 0.001305
0.018530 0.001292  0.018648 0.001313
0.018514 0.001291  0.018612 0.001308
0.018494 0.001290  0.018604 0.001308
0.018482 0.001289  0.018607 0.001307
0.018468 0.001287  0.018564 0.001306
0.018452 0.001286  0.018555 0.001304
0.018439 0.001285  0.018570 0.001304
0.018427 0.001284  0.018549 0.001303
0.018415 0.001283  0.018533 0.001301
0.018403 0.001282  0.018517 0.001299
0.018391 0.001281  0.018534 0.001306
0.018381 0.001281  0.018511 0.001303
0.018369 0.001280  0.018514 0.001300
0.018357 0.001279  0.018486 0.001297
0.018349 0.001278  0.018481 0.001298
0.018338 0.001277  0.018458 0.001299
0.018329 0.001277  0.018469 0.001301
0.018320 0.001276  0.018453 0.001297
0.018310 0.001275  0.018444 0.001297
0.018303 0.001274  0.018440 0.001297
0.018294 0.001274  0.018466 0.001295
0.018285 0.001273  0.018415 0.001296
0.018280 0.001273  0.018456 0.001296
0.018271 0.001272  0.018444 0.001296
0.018264 0.001271  0.018411 0.001293
0.018259 0.001271  0.018412 0.001295
0.018251 0.001270  0.018422 0.001294
0.018243 0.001270  0.018406 0.001296
0.018239 0.001269  0.018393 0.001294
0.018232 0.001268  0.018422 0.001294
0.018226 0.001268  0.018381 0.001294
0.018219 0.001267  0.018379 0.001294
0.018215 0.001267  0.018385 0.001293
0.018208 0.001266  0.018381 0.001294
0.018202 0.001266  0.018369 0.001294
0.018198 0.001266  0.018363 0.001289
0.018193 0.001265  0.018357 0.001292
0.018187 0.001265  0.018369 0.001293
0.018182 0.001264  0.018357 0.001294
0.018181 0.001264  0.018352 0.001291
0.018174 0.001263  0.018350 0.001290
0.018170 0.001263  0.018345 0.001292
0.018165 0.001262  0.018357 0.001293
0.018162 0.001262  0.018364 0.001292
0.018159 0.001262  0.018355 0.001296
0.018155 0.001262  0.018361 0.001292
0.018150 0.001261  0.018327 0.001291
0.018147 0.001261  0.018354 0.001292
0.018142 0.001260  0.018328 0.001294
0.018139 0.001260  0.018334 0.001294
0.018135 0.001260  0.018331 0.001293
0.018130 0.001259  0.018319 0.001289
0.018130 0.001259  0.018336 0.001293
0.018126 0.001259  0.018332 0.001290
0.018122 0.001258  0.018308 0.001289
0.018120 0.001258  0.018325 0.001292
0.018116 0.001258  0.018310 0.001291
0.018114 0.001258  0.018329 0.001292
0.018110 0.001257  0.018313 0.001290
0.018107 0.001257  0.018316 0.001289
0.018104 0.001257  0.018307 0.001289
0.018102 0.001256  0.018315 0.001290
0.018099 0.001256  0.018295 0.001289
0.018095 0.001256  0.018301 0.001290
0.018094 0.001255  0.018315 0.001288
0.018092 0.001255  0.018315 0.001288
0.018089 0.001255  0.018301 0.001289
0.018085 0.001255  0.018304 0.001291
0.018083 0.001254  0.018287 0.001288
0.018080 0.001254  0.018315 0.001294
0.018077 0.001254  0.018303 0.001291
0.018076 0.001254  0.018301 0.001290
0.018073 0.001253  0.018290 0.001291
0.018071 0.001253  0.018305 0.001290
0.018069 0.001253  0.018294 0.001289
0.018067 0.001253  0.018292 0.001290
0.018066 0.001253  0.018281 0.001288
0.018061 0.001252  0.018294 0.001289
0.018060 0.001252  0.018303 0.001290
0.018058 0.001252  0.018287 0.001286
0.018055 0.001251  0.018293 0.001290
0.018054 0.001251  0.018292 0.001292
0.018051 0.001251  0.018307 0.001291
0.018049 0.001251  0.018297 0.001293
0.018047 0.001251  0.018281 0.001292
0.018045 0.001250  0.018298 0.001292
0.018042 0.001250  0.018300 0.001290
0.018041 0.001250  0.018280 0.001290
0.018039 0.001250  0.018279 0.001289
0.018038 0.001250  0.018266 0.001288
0.018035 0.001249  0.018269 0.001290
0.018034 0.001249  0.018287 0.001291
0.018032 0.001249  0.018285 0.001287
0.018029 0.001249  0.018274 0.001289
0.018026 0.001248  0.018279 0.001292
0.018026 0.001248  0.018274 0.001289
0.018025 0.001248  0.018274 0.001287
0.018022 0.001248  0.018298 0.001290 

 ---------------------------------------------------  
Model Architecture:
Model: "model"
_____________________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     Trainable  
=============================================================================================================
 jet_input (InputLayer)         [(None, 6, 6)]       0           []                               Y          
                                                                                                             
 other_input (InputLayer)       [(None, 7)]          0           []                               Y          
                                                                                                             
 flattened_jets (Flatten)       (None, 36)           0           ['jet_input[0][0]']              Y          
                                                                                                             
 concat_jets_other (Concatenate  (None, 43)          0           ['other_input[0][0]',            Y          
 )                                                                'flattened_jets[0][0]']                    
                                                                                                             
 dense256_1 (Dense)             (None, 256)          11264       ['concat_jets_other[0][0]']      Y          
                                                                                                             
 masking_jets (Masking)         (None, 6, 6)         0           ['jet_input[0][0]']              Y          
                                                                                                             
 dense256_2 (Dense)             (None, 256)          65792       ['dense256_1[0][0]']             Y          
                                                                                                             
 reshape_masked_jets (Reshape)  (None, 6, 6)         0           ['masking_jets[0][0]']           Y          
                                                                                                             
 dense6_sigmoid (Dense)         (None, 6)            1542        ['dense256_2[0][0]']             Y          
                                                                                                             
 TDDense128 (TimeDistributed)   (None, 6, 128)       896         ['reshape_masked_jets[0][0]']    Y          
                                                                                                             
 reshape (Reshape)              (None, 6, 1)         0           ['dense6_sigmoid[0][0]']         Y          
                                                                                                             
 TDDense64 (TimeDistributed)    (None, 6, 64)        8256        ['TDDense128[0][0]']             Y          
                                                                                                             
 weight_jets (Multiply)         (None, 6, 64)        0           ['reshape[0][0]',                Y          
                                                                  'TDDense64[0][0]']                         
                                                                                                             
 dense128 (Dense)               (None, 128)          1024        ['other_input[0][0]']            Y          
                                                                                                             
 TDDense256_1 (TimeDistributed)  (None, 6, 256)      16640       ['weight_jets[0][0]']            Y          
                                                                                                             
 dense64 (Dense)                (None, 64)           8256        ['dense128[0][0]']               Y          
                                                                                                             
 TDDense256_2 (TimeDistributed)  (None, 6, 256)      65792       ['TDDense256_1[0][0]']           Y          
                                                                                                             
 flattened_other (Flatten)      (None, 64)           0           ['dense64[0][0]']                Y          
                                                                                                             
 flattened_weighted_jets (Flatt  (None, 1536)        0           ['TDDense256_2[0][0]']           Y          
 en)                                                                                                         
                                                                                                             
 concat_everything (Concatenate  (None, 1600)        0           ['flattened_other[0][0]',        Y          
 )                                                                'flattened_weighted_jets[0][0]             
                                                                 ']                                          
                                                                                                             
 ldense256 (Dense)              (None, 256)          409856      ['concat_everything[0][0]']      Y          
                                                                                                             
 ldense128 (Dense)              (None, 128)          32896       ['ldense256[0][0]']              Y          
                                                                                                             
 lep_output (Dense)             (None, 10)           1290        ['ldense128[0][0]']              Y          
                                                                                                             
 concatenate (Concatenate)      (None, 1610)         0           ['lep_output[0][0]',             Y          
                                                                  'concat_everything[0][0]']                 
                                                                                                             
 hdense256 (Dense)              (None, 256)          412416      ['concatenate[0][0]']            Y          
                                                                                                             
 hdense128 (Dense)              (None, 128)          32896       ['hdense256[0][0]']              Y          
                                                                                                             
 had_output (Dense)             (None, 10)           1290        ['hdense128[0][0]']              Y          
                                                                                                             
 output (Concatenate)           (None, 20)           0           ['had_output[0][0]',             Y          
                                                                  'lep_output[0][0]']                        
                                                                                                             
=============================================================================================================
Total params: 1,070,106
Trainable params: 1,070,106
Non-trainable params: 0
_____________________________________________________________________________________________________________
