Model Name: TRecNet 
Model ID: TRecNet_7jets_20230526_160845 

 ---------------------------------------------------  
Training Data File: /mnt/xrootdg/jchishol/mntuples_08_01_22/variables_ttbar_ljets_10j_train.h5 
X Maxmean File: /mnt/xrootdg/jchishol/mntuples_08_01_22/X_maxmean_variables_ttbar_ljets_10j_train.npy 
Y Maxmean File: /mnt/xrootdg/jchishol/mntuples_08_01_22/Y_maxmean_variables_ttbar_ljets_10j_train.npy 

 ---------------------------------------------------  
X Keys: j1_pt, j1_eta, j1_phi, j1_m, j1_isbtag, j2_pt, j2_eta, j2_phi, j2_m, j2_isbtag, j3_pt, j3_eta, j3_phi, j3_m, j3_isbtag, j4_pt, j4_eta, j4_phi, j4_m, j4_isbtag, j5_pt, j5_eta, j5_phi, j5_m, j5_isbtag, j6_pt, j6_eta, j6_phi, j6_m, j6_isbtag, j7_pt, j7_eta, j7_phi, j7_m, j7_isbtag, lep_pt, lep_eta, lep_phi, met_met, met_phi
X Scaled Keys: j1_pt, j1_px, j1_py, j1_eta, j1_m, j1_isbtag, j2_pt, j2_px, j2_py, j2_eta, j2_m, j2_isbtag, j3_pt, j3_px, j3_py, j3_eta, j3_m, j3_isbtag, j4_pt, j4_px, j4_py, j4_eta, j4_m, j4_isbtag, j5_pt, j5_px, j5_py, j5_eta, j5_m, j5_isbtag, j6_pt, j6_px, j6_py, j6_eta, j6_m, j6_isbtag, j7_pt, j7_px, j7_py, j7_eta, j7_m, j7_isbtag, lep_pt, lep_px, lep_py, lep_eta, met_met, met_phi-sin, met_phi-cos
Y Keys: th_pt, th_eta, th_phi, th_m, wh_pt, wh_eta, wh_phi, wh_m, tl_pt, tl_eta, tl_phi, tl_m, wl_pt, wl_eta, wl_phi, wl_m
Y Scaled Keys: th_pt, th_px, th_py, th_eta, th_m, wh_pt, wh_px, wh_py, wh_eta, wh_m, tl_pt, tl_px, tl_py, tl_eta, tl_m, wl_pt, wl_px, wl_py, wl_eta, wl_m

 ---------------------------------------------------  
Learning Rate: Polynomial Decay with initial_lr=0.001, final_lr=5e-05, decay_step=10000, and power=0.25 
Batch Size: 1000 
Max Number of Epochs: 256 
Number of Epochs Used: 149 
Patience: 8 
Training Time: 00:06:02:41 
Training History: 
     loss      mse  val_loss  val_mse
0.021113 0.001481  0.020098 0.001398
0.020002 0.001389  0.019978 0.001388
0.019898 0.001381  0.019893 0.001385
0.019818 0.001375  0.019827 0.001379
0.019750 0.001370  0.019782 0.001377
0.019689 0.001365  0.019727 0.001371
0.019636 0.001361  0.019673 0.001367
0.019589 0.001357  0.019631 0.001365
0.019546 0.001354  0.019597 0.001362
0.019506 0.001351  0.019563 0.001360
0.019470 0.001348  0.019528 0.001358
0.019436 0.001345  0.019507 0.001355
0.019403 0.001342  0.019475 0.001353
0.019373 0.001340  0.019447 0.001351
0.019344 0.001338  0.019419 0.001351
0.019317 0.001335  0.019399 0.001347
0.019291 0.001333  0.019379 0.001347
0.019267 0.001331  0.019358 0.001346
0.019243 0.001329  0.019338 0.001345
0.019221 0.001327  0.019324 0.001344
0.019199 0.001326  0.019300 0.001342
0.019178 0.001324  0.019282 0.001339
0.019159 0.001322  0.019268 0.001339
0.019140 0.001321  0.019257 0.001339
0.019122 0.001319  0.019236 0.001336
0.019105 0.001318  0.019222 0.001337
0.019088 0.001317  0.019214 0.001335
0.019073 0.001315  0.019198 0.001334
0.019058 0.001314  0.019193 0.001334
0.019043 0.001313  0.019178 0.001333
0.019030 0.001312  0.019181 0.001336
0.019017 0.001311  0.019160 0.001332
0.019004 0.001310  0.019142 0.001328
0.018991 0.001309  0.019139 0.001331
0.018979 0.001308  0.019131 0.001329
0.018967 0.001306  0.019129 0.001331
0.018956 0.001306  0.019105 0.001329
0.018945 0.001305  0.019102 0.001329
0.018935 0.001304  0.019094 0.001329
0.018924 0.001303  0.019081 0.001327
0.018914 0.001302  0.019080 0.001325
0.018904 0.001301  0.019068 0.001326
0.018895 0.001300  0.019063 0.001327
0.018885 0.001300  0.019060 0.001326
0.018877 0.001299  0.019052 0.001325
0.018868 0.001298  0.019044 0.001323
0.018859 0.001297  0.019044 0.001328
0.018851 0.001297  0.019030 0.001326
0.018843 0.001296  0.019032 0.001325
0.018835 0.001295  0.019032 0.001325
0.018827 0.001295  0.019007 0.001323
0.018820 0.001294  0.019019 0.001324
0.018813 0.001293  0.019005 0.001321
0.018805 0.001293  0.018996 0.001324
0.018798 0.001292  0.018990 0.001322
0.018791 0.001291  0.018986 0.001323
0.018785 0.001291  0.018983 0.001323
0.018778 0.001290  0.018983 0.001322
0.018772 0.001290  0.018981 0.001321
0.018765 0.001289  0.018979 0.001321
0.018759 0.001289  0.018974 0.001322
0.018753 0.001288  0.018963 0.001320
0.018747 0.001288  0.018973 0.001324
0.018741 0.001287  0.018963 0.001320
0.018736 0.001287  0.018961 0.001319
0.018730 0.001286  0.018956 0.001319
0.018724 0.001286  0.018947 0.001320
0.018719 0.001285  0.018949 0.001320
0.018713 0.001285  0.018945 0.001321
0.018707 0.001284  0.018941 0.001320
0.018703 0.001284  0.018943 0.001320
0.018697 0.001283  0.018937 0.001321
0.018692 0.001283  0.018933 0.001319
0.018688 0.001282  0.018933 0.001321
0.018682 0.001282  0.018928 0.001318
0.018678 0.001282  0.018921 0.001321
0.018673 0.001281  0.018923 0.001319
0.018668 0.001281  0.018918 0.001320
0.018664 0.001280  0.018909 0.001321
0.018659 0.001280  0.018910 0.001319
0.018655 0.001279  0.018911 0.001320
0.018650 0.001279  0.018912 0.001321
0.018646 0.001279  0.018900 0.001317
0.018642 0.001278  0.018902 0.001320
0.018637 0.001278  0.018894 0.001316
0.018633 0.001277  0.018897 0.001318
0.018629 0.001277  0.018895 0.001317
0.018624 0.001277  0.018902 0.001321
0.018621 0.001276  0.018888 0.001316
0.018617 0.001276  0.018879 0.001318
0.018613 0.001276  0.018889 0.001320
0.018609 0.001275  0.018882 0.001318
0.018605 0.001275  0.018882 0.001317
0.018601 0.001274  0.018879 0.001318
0.018598 0.001274  0.018884 0.001321
0.018594 0.001274  0.018878 0.001317
0.018591 0.001273  0.018875 0.001316
0.018588 0.001273  0.018881 0.001317
0.018584 0.001273  0.018885 0.001318
0.018581 0.001273  0.018871 0.001317
0.018578 0.001272  0.018871 0.001319
0.018575 0.001272  0.018868 0.001319
0.018571 0.001272  0.018870 0.001318
0.018568 0.001271  0.018871 0.001319
0.018565 0.001271  0.018863 0.001320
0.018562 0.001271  0.018860 0.001318
0.018559 0.001270  0.018864 0.001318
0.018556 0.001270  0.018856 0.001318
0.018553 0.001270  0.018867 0.001319
0.018550 0.001269  0.018854 0.001316
0.018547 0.001269  0.018855 0.001319
0.018544 0.001269  0.018875 0.001319
0.018541 0.001269  0.018853 0.001318
0.018538 0.001268  0.018855 0.001321
0.018536 0.001268  0.018851 0.001316
0.018533 0.001268  0.018853 0.001320
0.018530 0.001268  0.018850 0.001319
0.018527 0.001267  0.018853 0.001317
0.018525 0.001267  0.018850 0.001319
0.018522 0.001267  0.018853 0.001316
0.018519 0.001266  0.018846 0.001317
0.018517 0.001266  0.018842 0.001317
0.018514 0.001266  0.018840 0.001318
0.018512 0.001266  0.018845 0.001320
0.018509 0.001265  0.018843 0.001318
0.018506 0.001265  0.018848 0.001317
0.018503 0.001265  0.018836 0.001318
0.018501 0.001265  0.018841 0.001317
0.018499 0.001264  0.018839 0.001319
0.018497 0.001264  0.018843 0.001319
0.018494 0.001264  0.018838 0.001317
0.018492 0.001264  0.018840 0.001317
0.018489 0.001263  0.018836 0.001317
0.018487 0.001263  0.018832 0.001318
0.018485 0.001263  0.018836 0.001318
0.018483 0.001263  0.018831 0.001319
0.018480 0.001262  0.018828 0.001318
0.018478 0.001262  0.018828 0.001316
0.018476 0.001262  0.018829 0.001319
0.018474 0.001262  0.018829 0.001316
0.018472 0.001262  0.018824 0.001318
0.018470 0.001261  0.018837 0.001320
0.018468 0.001261  0.018824 0.001318
0.018466 0.001261  0.018841 0.001322
0.018464 0.001261  0.018840 0.001320
0.018461 0.001260  0.018835 0.001318
0.018459 0.001260  0.018834 0.001319
0.018458 0.001260  0.018838 0.001320
0.018456 0.001260  0.018826 0.001320 

 ---------------------------------------------------  
Model Architecture:
Model: "model"
_____________________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     Trainable  
=============================================================================================================
 jet_input (InputLayer)         [(None, 7, 6)]       0           []                               Y          
                                                                                                             
 other_input (InputLayer)       [(None, 7)]          0           []                               Y          
                                                                                                             
 flattened_jets (Flatten)       (None, 42)           0           ['jet_input[0][0]']              Y          
                                                                                                             
 concat_jets_other (Concatenate  (None, 49)          0           ['other_input[0][0]',            Y          
 )                                                                'flattened_jets[0][0]']                    
                                                                                                             
 dense256_1 (Dense)             (None, 256)          12800       ['concat_jets_other[0][0]']      Y          
                                                                                                             
 masking_jets (Masking)         (None, 7, 6)         0           ['jet_input[0][0]']              Y          
                                                                                                             
 dense256_2 (Dense)             (None, 256)          65792       ['dense256_1[0][0]']             Y          
                                                                                                             
 reshape_masked_jets (Reshape)  (None, 7, 6)         0           ['masking_jets[0][0]']           Y          
                                                                                                             
 dense6_sigmoid (Dense)         (None, 7)            1799        ['dense256_2[0][0]']             Y          
                                                                                                             
 TDDense128 (TimeDistributed)   (None, 7, 128)       896         ['reshape_masked_jets[0][0]']    Y          
                                                                                                             
 reshape (Reshape)              (None, 7, 1)         0           ['dense6_sigmoid[0][0]']         Y          
                                                                                                             
 TDDense64 (TimeDistributed)    (None, 7, 64)        8256        ['TDDense128[0][0]']             Y          
                                                                                                             
 weight_jets (Multiply)         (None, 7, 64)        0           ['reshape[0][0]',                Y          
                                                                  'TDDense64[0][0]']                         
                                                                                                             
 dense128 (Dense)               (None, 128)          1024        ['other_input[0][0]']            Y          
                                                                                                             
 TDDense256_1 (TimeDistributed)  (None, 7, 256)      16640       ['weight_jets[0][0]']            Y          
                                                                                                             
 dense64 (Dense)                (None, 64)           8256        ['dense128[0][0]']               Y          
                                                                                                             
 TDDense256_2 (TimeDistributed)  (None, 7, 256)      65792       ['TDDense256_1[0][0]']           Y          
                                                                                                             
 flattened_other (Flatten)      (None, 64)           0           ['dense64[0][0]']                Y          
                                                                                                             
 flattened_weighted_jets (Flatt  (None, 1792)        0           ['TDDense256_2[0][0]']           Y          
 en)                                                                                                         
                                                                                                             
 concat_everything (Concatenate  (None, 1856)        0           ['flattened_other[0][0]',        Y          
 )                                                                'flattened_weighted_jets[0][0]             
                                                                 ']                                          
                                                                                                             
 ldense256 (Dense)              (None, 256)          475392      ['concat_everything[0][0]']      Y          
                                                                                                             
 ldense128 (Dense)              (None, 128)          32896       ['ldense256[0][0]']              Y          
                                                                                                             
 lep_output (Dense)             (None, 10)           1290        ['ldense128[0][0]']              Y          
                                                                                                             
 concatenate (Concatenate)      (None, 1866)         0           ['lep_output[0][0]',             Y          
                                                                  'concat_everything[0][0]']                 
                                                                                                             
 hdense256 (Dense)              (None, 256)          477952      ['concatenate[0][0]']            Y          
                                                                                                             
 hdense128 (Dense)              (None, 128)          32896       ['hdense256[0][0]']              Y          
                                                                                                             
 had_output (Dense)             (None, 10)           1290        ['hdense128[0][0]']              Y          
                                                                                                             
 output (Concatenate)           (None, 20)           0           ['had_output[0][0]',             Y          
                                                                  'lep_output[0][0]']                        
                                                                                                             
=============================================================================================================
Total params: 1,202,971
Trainable params: 1,202,971
Non-trainable params: 0
_____________________________________________________________________________________________________________
